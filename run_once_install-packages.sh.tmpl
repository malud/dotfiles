#!/usr/bin/env bash
{{ if eq .chezmoi.os "darwin" -}}
set -euo pipefail

echo "üì¶ Installing Brewfile packages..."

# Detect Homebrew location and ensure it's in PATH
if [ -f /opt/homebrew/bin/brew ]; then
  eval "$(/opt/homebrew/bin/brew shellenv)"
  BREW_PATH="/opt/homebrew/bin/brew"
elif [ -f /usr/local/bin/brew ]; then
  eval "$(/usr/local/bin/brew shellenv)"
  BREW_PATH="/usr/local/bin/brew"
else
  echo "‚ùå Homebrew not found. Please install it first:"
  echo "   /bin/bash -c \"\$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\""
  exit 1
fi

echo "‚ÑπÔ∏è  Using brew at: $BREW_PATH"

brew bundle --file="${HOME}/.Brewfile"

echo "‚úÖ Homebrew packages installed!"

{{ else -}}
echo "‚ÑπÔ∏è  This script is for macOS only"
echo "‚ÑπÔ∏è  Linux packages are installed via run_once_install-modern-tools.sh.tmpl"
exit 0
{{ end -}}

