#!/usr/bin/env bash
{{ if ne .chezmoi.os "darwin" -}}
set -euo pipefail

# Hash triggers re-run when playbook changes: {{ include "dot_config/ansible/playbook.yml" | sha256sum }}

echo "üöÄ Running Ansible playbook..."

export PATH="${HOME}/.local/bin:${PATH}"

if ! command -v uv &>/dev/null; then
  echo "‚ùå uv not found. Please run the install-uv script first."
  exit 1
fi

cd "${HOME}/.config/ansible"
uvx --from ansible ansible-playbook playbook.yml

echo "‚úÖ Ansible playbook completed!"

{{ else -}}
echo "‚ÑπÔ∏è  This script is for Linux only - skipping on macOS"
exit 0
{{ end -}}
